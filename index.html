<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sunday School Exam System</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <style>
    body { margin: 0; font-family: system-ui, -apple-system, sans-serif; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script>
    const { useState, useEffect, useCallback, createElement: h } = React;
    const { createRoot } = ReactDOM;

    function ExamSystem() {
      const [view, setView] = useState('login');
      const [studentName, setStudentName] = useState('');
      const [examData, setExamData] = useState(null);
      const [currentQuestion, setCurrentQuestion] = useState(0);
      const [answers, setAnswers] = useState({});
      const [timeLeft, setTimeLeft] = useState(0);
      const [examStarted, setExamStarted] = useState(false);
      const [allResults, setAllResults] = useState([]);
      const [isAdmin, setIsAdmin] = useState(false);
      const [isSpeaking, setIsSpeaking] = useState(false);
      const adminPassword = 'admin123';
      const [passwordInput, setPasswordInput] = useState('');

      // Load data from localStorage on mount
      useEffect(() => {
        const loadData = () => {
          try {
            const examResult = localStorage.getItem('current-exam');
            const resultsResult = localStorage.getItem('all-results');

            if (examResult) {
              setExamData(JSON.parse(examResult));
            }
            if (resultsResult) {
              setAllResults(JSON.parse(resultsResult));
            }
          } catch (error) {
            console.error('Error loading data:', error);
          }
        };
        loadData();
      }, []);

      // Save results to localStorage whenever they change
      useEffect(() => {
        if (allResults.length > 0) {
          try {
            localStorage.setItem('all-results', JSON.stringify(allResults));
          } catch (err) {
            console.error('Failed to save results:', err);
          }
        }
      }, [allResults]);

      const speakQuestion = (text) => {
        if ('speechSynthesis' in window) {
          window.speechSynthesis.cancel();

          if (isSpeaking) {
            setIsSpeaking(false);
            return;
          }

          const utterance = new SpeechSynthesisUtterance(text);
          utterance.rate = 0.9;
          utterance.pitch = 1;
          utterance.volume = 1;

          utterance.onstart = () => setIsSpeaking(true);
          utterance.onend = () => setIsSpeaking(false);
          utterance.onerror = () => setIsSpeaking(false);

          window.speechSynthesis.speak(utterance);
        } else {
          alert('Text-to-speech is not supported in your browser.');
        }
      };

      // Cleanup speech synthesis when question changes
      useEffect(() => {
        return () => {
          if ('speechSynthesis' in window) {
            window.speechSynthesis.cancel();
          }
        };
      }, [currentQuestion]);

      const handleLogin = (e) => {
        if (e) e.preventDefault();
        if (studentName.trim()) {
          if (studentName.toLowerCase() === 'admin') {
            setView('admin-password');
          } else {
            if (!examData) {
              alert('No exam is currently available. Please wait for the teacher to upload an exam.');
              return;
            }
            setView('exam');
            setTimeLeft(examData.duration * 60 || 1800);
            setExamStarted(true);
            setAnswers({});
            setCurrentQuestion(0);
          }
        }
      };

      const handleAdminLogin = () => {
        if (passwordInput === adminPassword) {
          setIsAdmin(true);
          setView('admin');
          setPasswordInput('');
        } else {
          alert('Incorrect password!');
        }
      };

      const handleFileUpload = (e) => {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = (event) => {
            try {
              const json = JSON.parse(event.target.result);
              if (json.questions && json.questions.length > 0) {
                setExamData(json);
                try {
                  localStorage.setItem('current-exam', JSON.stringify(json));
                  alert(`Exam "${json.examName}" uploaded successfully! Students can now take the exam.`);
                } catch (storageError) {
                  console.error('Failed to save exam:', storageError);
                  alert('Exam loaded but could not be saved. It will be lost on page refresh.');
                }
              } else {
                alert('Invalid JSON format. Please check your file.');
              }
            } catch (error) {
              alert('Error reading file. Please upload a valid JSON file.');
            }
          };
          reader.readAsText(file);
        }
      };

      const clearExam = () => {
        if (confirm('Are you sure you want to remove the current exam?')) {
          setExamData(null);
          try {
            localStorage.removeItem('current-exam');
            alert('Exam removed successfully!');
          } catch (error) {
            console.error('Failed to delete exam:', error);
          }
        }
      };

      const clearAllResults = () => {
        if (confirm('Are you sure you want to delete ALL student results? This cannot be undone!')) {
          setAllResults([]);
          try {
            localStorage.removeItem('all-results');
            alert('All results cleared!');
          } catch (error) {
            console.error('Failed to clear results:', error);
          }
        }
      };

      const handleAnswerSelect = (questionIndex, optionIndex) => {
        setAnswers({ ...answers, [questionIndex]: optionIndex });
      };

      const calculateScore = () => {
        if (!examData || !examData.questions) {
          return { score: 0, total: 0, percentage: '0.00' };
        }

        let correct = 0;
        examData.questions.forEach((q, index) => {
          if (answers[index] === q.correct) {
            correct++;
          }
        });
        return {
          score: correct,
          total: examData.questions.length,
          percentage: ((correct / examData.questions.length) * 100).toFixed(2)
        };
      };

      const handleSubmit = useCallback(() => {
        if (!examData) return;

        setExamStarted(false);
        const result = calculateScore();

        const newResult = {
          examName: examData.examName || 'Untitled Exam',
          studentName: studentName,
          marks: `${result.score}/${result.total}`,
          percentage: result.percentage,
          timestamp: new Date().toLocaleString()
        };

        const updatedResults = [...allResults, newResult];

        const sortedResults = [...updatedResults].sort((a, b) => 
          parseFloat(b.percentage) - parseFloat(a.percentage)
        );

        const resultsWithRank = updatedResults.map(r => ({
          ...r,
          rank: sortedResults.findIndex(sr => 
            sr.studentName === r.studentName && sr.timestamp === r.timestamp
          ) + 1
        })).sort((a, b) => a.rank - b.rank);

        setAllResults(resultsWithRank);
        setView('results');
      }, [examData, studentName, allResults, answers]);

      // Timer effect with proper dependencies
      useEffect(() => {
        if (examStarted && timeLeft > 0) {
          const timer = setTimeout(() => setTimeLeft(timeLeft - 1), 1000);
          return () => clearTimeout(timer);
        } else if (examStarted && timeLeft === 0) {
          handleSubmit();
        }
      }, [timeLeft, examStarted, handleSubmit]);

      const exportToExcel = () => {
        if (typeof XLSX === 'undefined') {
          alert('Excel export library not loaded. Please refresh the page and try again.');
          return;
        }

        if (allResults.length === 0) {
          alert('No results to export.');
          return;
        }

        try {
          const worksheet = XLSX.utils.json_to_sheet(allResults);
          const workbook = XLSX.utils.book_new();
          XLSX.utils.book_append_sheet(workbook, worksheet, 'Results');
          XLSX.writeFile(workbook, `${examData?.examName || 'Exam'}_Results.xlsx`);
        } catch (error) {
          console.error('Export error:', error);
          alert('Failed to export results. Please try again.');
        }
      };

      const formatTime = (seconds) => {
        const mins = Math.floor(seconds / 60);
        const secs = seconds % 60;
        return `${mins}:${secs.toString().padStart(2, '0')}`;
      };

      const resetApp = () => {
        setView('login');
        setStudentName('');
        setCurrentQuestion(0);
        setAnswers({});
        setTimeLeft(0);
        setExamStarted(false);
        setIsAdmin(false);
        setPasswordInput('');
      };

      // SVG Icons
      const icons = {
        clock: h('svg', {width:24,height:24,viewBox:'0 0 24 24',fill:'none',stroke:'currentColor',strokeWidth:2},
          h('circle',{cx:12,cy:12,r:10}),
          h('polyline',{points:'12 6 12 12 16 14'})
        ),
        upload: h('svg', {width:20,height:20,viewBox:'0 0 24 24',fill:'none',stroke:'currentColor',strokeWidth:2},
          h('path',{d:'M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4'}),
          h('polyline',{points:'17 8 12 3 7 8'}),
          h('line',{x1:12,y1:3,x2:12,y2:15})
        ),
        check: h('svg', {width:24,height:24,viewBox:'0 0 24 24',fill:'none',stroke:'currentColor',strokeWidth:2},
          h('path',{d:'M22 11.08V12a10 10 0 1 1-5.93-9.14'}),
          h('polyline',{points:'22 4 12 14.01 9 11.01'})
        ),
        alert: h('svg', {width:24,height:24,viewBox:'0 0 24 24',fill:'none',stroke:'currentColor',strokeWidth:2},
          h('circle',{cx:12,cy:12,r:10}),
          h('line',{x1:12,y1:8,x2:12,y2:12}),
          h('line',{x1:12,y1:16,x2:12.01,y2:16})
        ),
        download: h('svg', {width:20,height:20,viewBox:'0 0 24 24',fill:'none',stroke:'currentColor',strokeWidth:2},
          h('path',{d:'M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4'}),
          h('polyline',{points:'7 10 12 15 17 10'}),
          h('line',{x1:12,y1:15,x2:12,y2:3})
        ),
        users: h('svg', {width:40,height:40,viewBox:'0 0 24 24',fill:'none',stroke:'currentColor',strokeWidth:2},
          h('path',{d:'M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2'}),
          h('circle',{cx:9,cy:7,r:4}),
          h('path',{d:'M23 21v-2a4 4 0 0 0-3-3.87'}),
          h('path',{d:'M16 3.13a4 4 0 0 1 0 7.75'})
        ),
        volume: h('svg', {width:24,height:24,viewBox:'0 0 24 24',fill:'none',stroke:'currentColor',strokeWidth:2},
          h('polygon',{points:'11 5 6 9 2 9 2 15 6 15 11 19 11 5'}),
          h('path',{d:'M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07'})
        ),
        volumeX: h('svg', {width:24,height:24,viewBox:'0 0 24 24',fill:'none',stroke:'currentColor',strokeWidth:2},
          h('polygon',{points:'11 5 6 9 2 9 2 15 6 15 11 19 11 5'}),
          h('line',{x1:23,y1:9,x2:17,y2:15}),
          h('line',{x1:17,y1:9,x2:23,y2:15})
        ),
        trash: h('svg', {width:16,height:16,viewBox:'0 0 24 24',fill:'none',stroke:'currentColor',strokeWidth:2},
          h('polyline',{points:'3 6 5 6 21 6'}),
          h('path',{d:'M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2'})
        )
      };

      if (view === 'login') {
        return h('div', {className:'min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4'},
          h('div', {className:'bg-white rounded-2xl shadow-xl p-8 w-full max-w-md'},
            h('div', {className:'text-center mb-8'},
              h('div', {className:'bg-indigo-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4'}, icons.users),
              h('h1', {className:'text-3xl font-bold text-gray-800'}, 'Sunday School Exam'),
              h('p', {className:'text-gray-600 mt-2'}, 'Enter your name to begin'),
              examData && h('div', {className:'mt-4 bg-green-50 border border-green-200 rounded-lg p-3'},
                h('p', {className:'text-sm text-green-800 font-semibold'}, 'ðŸ“ Current Exam: ' + examData.examName),
                h('p', {className:'text-xs text-green-600 mt-1'}, `${examData.questions.length} questions â€¢ ${examData.duration || 30} minutes`)
              ),
              !examData && h('div', {className:'mt-4 bg-yellow-50 border border-yellow-200 rounded-lg p-3'},
                h('p', {className:'text-sm text-yellow-800'}, 'â³ No exam available yet. Please wait for teacher.')
              )
            ),
            h('div', null,
              h('input', {
                type:'text',
                value:studentName,
                onChange:(e)=>setStudentName(e.target.value),
                placeholder:'Your Full Name',
                className:'w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-indigo-500 mb-4',
                onKeyPress:(e)=>e.key==='Enter'&&handleLogin()
              }),
              h('button', {
                onClick:handleLogin,
                className:'w-full bg-indigo-600 text-white py-3 rounded-lg font-semibold hover:bg-indigo-700 transition'
              }, examData ? 'Start Exam' : 'Login')
            ),
            h('p', {className:'text-sm text-gray-500 text-center mt-4'}, 'Type "admin" to access teacher dashboard')
          )
        );
      }

      if (view === 'admin-password') {
        return h('div', {className:'min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4'},
          h('div', {className:'bg-white rounded-2xl shadow-xl p-8 w-full max-w-md'},
            h('div', {className:'text-center mb-8'},
              h('div', {className:'bg-red-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4'}, icons.alert),
              h('h2', {className:'text-2xl font-bold text-gray-800'}, 'Admin Access'),
              h('p', {className:'text-gray-600 mt-2'}, 'Enter admin password')
            ),
            h('div', null,
              h('input', {
                type:'password',
                value:passwordInput,
                onChange:(e)=>setPasswordInput(e.target.value),
                placeholder:'Password',
                className:'w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-indigo-500 mb-4',
                onKeyPress:(e)=>e.key==='Enter'&&handleAdminLogin()
              }),
              h('button', {
                onClick:handleAdminLogin,
                className:'w-full bg-red-600 text-white py-3 rounded-lg font-semibold hover:bg-red-700 transition mb-2'
              }, 'Login as Admin'),
              h('button', {
                onClick:resetApp,
                className:'w-full px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50'
              }, 'Back')
            )
          )
        );
      }

      if (view === 'admin' && isAdmin) {
        return h('div', {className:'min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4'},
          h('div', {className:'max-w-6xl mx-auto'},
            h('div', {className:'bg-white rounded-2xl shadow-xl p-8'},
              h('div', {className:'flex justify-between items-center mb-6'},
                h('h1', {className:'text-3xl font-bold text-gray-800'}, 'Teacher Dashboard'),
                h('button', {onClick:resetApp,className:'px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600'}, 'Logout')
              ),
              h('div', {className:'bg-blue-50 border-2 border-blue-200 rounded-xl p-6 mb-6'},
                h('h2', {className:'text-xl font-bold text-gray-800 mb-4'}, 'ðŸ“š Manage Exam'),
                examData ? h('div', {className:'bg-white rounded-lg p-4 mb-4'},
                  h('div', {className:'flex justify-between items-start'},
                    h('div', null,
                      h('p', {className:'font-semibold text-lg text-gray-800'}, examData.examName),
                      h('p', {className:'text-sm text-gray-600 mt-1'}, `${examData.questions.length} questions â€¢ ${examData.duration || 30} minutes`)
                    ),
                    h('button', {onClick:clearExam,className:'flex items-center gap-2 px-3 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200'},
                      icons.trash, ' Remove'
                    )
                  )
                ) : h('div', {className:'text-center py-4 mb-4'},
                  h('p', {className:'text-gray-600'}, 'No exam uploaded yet')
                ),
                h('label', {className:'block'},
                  h('div', {className:'flex items-center gap-2 mb-2'},
                    icons.upload,
                    h('span', {className:'font-semibold text-gray-700'}, 'Upload New Exam (JSON)')
                  ),
                  h('input', {
                    type:'file',
                    accept:'.json',
                    onChange:handleFileUpload,
                    className:'block w-full text-sm text-gray-500 file:mr-4 file:py-3 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100 cursor-pointer'
                  })
                )
              ),
              h('div', {className:'bg-green-50 border-2 border-green-200 rounded-xl p-6'},
                h('div', {className:'flex justify-between items-center mb-4'},
                  h('h2', {className:'text-xl font-bold text-gray-800'}, 'ðŸ“Š Student Results'),
                  allResults.length > 0 && h('div', {className:'flex gap-2'},
                    h('button', {onClick:exportToExcel,className:'flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700'},
                      icons.download, ' Export Excel'
                    ),
                    h('button', {onClick:clearAllResults,className:'flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700'},
                      icons.trash, ' Clear All'
                    )
                  )
                ),
                allResults.length === 0 ? h('div', {className:'text-center py-12'},
                  h('div', {className:'mx-auto mb-4 text-gray-400'}, icons.alert),
                  h('p', {className:'text-gray-500 text-lg'}, 'No student results yet')
                ) : h('div', {className:'bg-white rounded-lg overflow-hidden'},
                  h('div', {className:'overflow-x-auto'},
                    h('table', {className:'w-full'},
                      h('thead', {className:'bg-gray-100'},
                        h('tr', null,
                          h('th', {className:'px-4 py-3 text-left font-semibold'}, 'Rank'),
                          h('th', {className:'px-4 py-3 text-left font-semibold'}, 'Student Name'),
                          h('th', {className:'px-4 py-3 text-left font-semibold'}, 'Exam Name'),
                          h('th', {className:'px-4 py-3 text-left font-semibold'}, 'Marks'),
                          h('th', {className:'px-4 py-3 text-left font-semibold'}, 'Percentage'),
                          h('th', {className:'px-4 py-3 text-left font-semibold'}, 'Date & Time')
                        )
                      ),
                      h('tbody', null,
                        allResults.sort((a,b)=>a.rank-b.rank).map((result,idx)=>
                          h('tr', {key:idx,className:'border-b hover:bg-gray-50'},
                            h('td', {className:'px-4 py-3'},
                              h('span', {className:`font-bold ${result.rank===1?'text-yellow-600':result.rank===2?'text-gray-500':result.rank===3?'text-orange-600':'text-gray-800'}`},
                                '#' + result.rank
                              )
                            ),
                            h('td', {className:'px-4 py-3 font-medium'}, result.studentName),
                            h('td', {className:'px-4 py-3 text-gray-600'}, result.examName),
                            h('td', {className:'px-4 py-3 font-semibold'}, result.marks),
                            h('td', {className:'px-4 py-3'},
                              h('span', {className:`font-semibold ${parseFloat(result.percentage)>=70?'text-green-600':parseFloat(result.percentage)>=50?'text-yellow-600':'text-red-600'}`},
                                result.percentage + '%'
                              )
                            ),
                            h('td', {className:'px-4 py-3 text-sm text-gray-600'}, result.timestamp)
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        );
      }

      if (view === 'exam' && examData) {
        const question = examData.questions[currentQuestion];
        const progress = ((currentQuestion + 1) / examData.questions.length) * 100;

        return h('div', {className:'min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4'},
          h('div', {className:'max-w-4xl mx-auto'},
            h('div', {className:'bg-white rounded-t-2xl shadow-xl p-6'},
              h('div', {className:'flex justify-between items-center mb-4'},
                h('div', null,
                  h('h2', {className:'text-2xl font-bold text-gray-800'}, examData.examName),
                  h('p', {className:'text-gray-600'}, 'Student: ' + studentName)
                ),
                h('div', {className:'flex items-center gap-2 bg-red-100 px-4 py-2 rounded-lg'},
                  icons.clock,
                  h('span', {className:'text-2xl font-bold text-red-600'}, formatTime(timeLeft))
                )
              ),
              h('div', {className:'w-full bg-gray-200 rounded-full h-2'},
                h('div', {className:'bg-indigo-600 h-2 rounded-full transition-all',style:{width:progress+'%'}})
              ),
              h('p', {className:'text-sm text-gray-600 mt-2'}, `Question ${currentQuestion + 1} of ${examData.questions.length}`)
            ),
            h('div', {className:'bg-white shadow-xl p-8 mb-4'},
              h('div', {className:'flex items-start justify-between gap-4 mb-6'},
                h('h3', {className:'text-xl font-semibold text-gray-800 flex-1'}, question.question),
                h('button', {
                  onClick:()=>speakQuestion(question.question),
                  className:`flex-shrink-0 p-3 rounded-full transition ${isSpeaking?'bg-red-100 hover:bg-red-200':'bg-indigo-100 hover:bg-indigo-200'}`,
                  title:isSpeaking?'Stop reading':'Read question aloud'
                }, isSpeaking ? icons.volumeX : icons.volume)
              ),
              h('div', {className:'space-y-3'},
                question.options.map((option,idx)=>
                  h('button', {
                    key:idx,
                    onClick:()=>handleAnswerSelect(currentQuestion,idx),
                    className:`w-full text-left px-6 py-4 rounded-lg border-2 transition ${answers[currentQuestion]===idx?'border-indigo-600 bg-indigo-50 font-semibold':'border-gray-300 hover:border-indigo-300 hover:bg-gray-50'}`
                  },
                    h('span', {className:'font-semibold text-indigo-600 mr-3'}, String.fromCharCode(65+idx)+'.'),
                    option
                  )
                )
              )
            ),
            h('div', {className:'bg-white rounded-b-2xl shadow-xl p-6 flex justify-between'},
              h('button', {
                onClick:()=>setCurrentQuestion(Math.max(0,currentQuestion-1)),
                disabled:currentQuestion===0,
                className:'px-6 py-2 bg-gray-300 text-gray-700 rounded-lg font-semibold disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-400'
              }, 'Previous'),
              currentQuestion < examData.questions.length-1 ?
                h('button', {
                  onClick:()=>setCurrentQuestion(currentQuestion+1),
                  className:'px-6 py-2 bg-indigo-600 text-white rounded-lg font-semibold hover:bg-indigo-700'
                }, 'Next') :
                h('button', {
                  onClick:handleSubmit,
                  className:'px-6 py-2 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 flex items-center gap-2'
                }, icons.check, ' Submit Exam')
            )
          )
        );
      }

      if (view === 'results') {
        const result = calculateScore();
        const myResult = allResults.find(r => 
          r.studentName === studentName && 
          r.examName === (examData?.examName || 'Untitled Exam')
        );

        return h('div', {className:'min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4'},
          h('div', {className:'bg-white rounded-2xl shadow-xl p-8 w-full max-w-2xl'},
            h('div', {className:'text-center mb-8'},
              h('div', {className:`w-24 h-24 rounded-full flex items-center justify-center mx-auto mb-4 ${
                Number(result?.percentage) >= 70 ? 'bg-green-100' : Number(result?.percentage) >= 50 ? 'bg-yellow-100' : 'bg-red-100'
              }`}, 
                icons.check
              ),
              h('h2', {className:'text-3xl font-bold text-gray-800 mb-2'}, 'Exam Completed!'),
              h('p', {className:'text-gray-600'}, studentName)
            ),
            h('div', {className:'bg-gray-50 rounded-xl p-6 mb-6'},
              h('div', {className:'grid grid-cols-2 md:grid-cols-4 gap-6'},
                h('div', {className:'text-center'},
                  h('p', {className:'text-gray-600 mb-2'}, 'Score'),
                  h('p', {className:'text-3xl font-bold text-indigo-600'}, `${result?.score || 0}/${result?.total || 0}`)
                ),
                h('div', {className:'text-center'},
                  h('p', {className:'text-gray-600 mb-2'}, 'Percentage'),
                  h('p', {className:'text-3xl font-bold text-indigo-600'}, `${Number(result?.percentage) || 0}%`)
                ),
                h('div', {className:'text-center'},
                  h('p', {className:'text-gray-600 mb-2'}, 'Exam'),
                  h('p', {className:'text-lg font-semibold text-gray-800'}, examData?.examName || 'Unknown Exam')
                ),
                h('div', {className:'text-center'},
                  h('p', {className:'text-gray-600 mb-2'}, 'Your Rank'),
                  h('p', {className:'text-3xl font-bold text-purple-600'}, '#'+(myResult?.rank || '-'))
                )
              )
            ),
            h('button', {
              onClick:resetApp,
              className:'w-full bg-indigo-600 text-white py-3 rounded-lg font-semibold hover:bg-indigo-700'
            }, 'Back to Home')
          )
        );
      }

      return null;
    }

    const root = createRoot(document.getElementById('root'));
    root.render(h(ExamSystem));
  </script>
</body>
</html>